<!DOCTYPE html>
<html>
  <head>
    <!-- Bootstrap JS and dependencies -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
    <script type="text/javascript" src="./js/bootstrap.min.js"></script>
    <!-- /Bootstrap JS and dependencies -->

    <!-- Our CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="./css/amazon-hq2-propsals.css" rel="stylesheet" />
    <!-- /Our CSS -->

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin=""></script>
    <!-- /Leaflet -->

    <script type="text/javascript">
/**
 * To add a new proposal to the view, simply create a new object that contains
 * the location, the country, the lat/long of the location, and a link to the
 * proposal.
 *
 * Example:
 *
 *   {
 *     "region": "Portland",
 *     "state": "Oregon",
 *     "country": "United States",
 *     "loc": [45.5231, -122.6765],
 *     "pdf": "https://greaterportlandinc.com/assets/documents/greaterportlandinc-amazonhq2.pdf",
 *     "video": "",
 *     "website": "",
 *     "locations": ""
 *   }
 *
 */
window.PROPOSALS = [
  {
    "region": "Portland",
    "state": "Oregon",
    "country": "United States",
    "loc": [45.5231, -122.6765],
    "pdf": "https://greaterportlandinc.com/assets/documents/greaterportlandinc-amazonhq2.pdf",
    "video": "",
    "website": "",
    "locations": ""
  },
  {
    "region": "Toronto",
    "state": "Ontario",
    "country": "Canada",
    "loc": [43.6532, -79.3832],
    "pdf": "https://s3.ca-central-1.amazonaws.com/torontoglobal/TorontoRegionResponsetoAmazonHQ2RFP_PD.pdf",
    "video": "",
    "website": "",
    "locations": ""
  },
  {
    "region": "Pittsburgh",
    "state": "Pennsylvania",
    "country": "United States",
    "loc": [40.4406, -79.9959],
    "pdf": "",
    "video": "https://www.youtube.com/watch?v=XEw2Ky5XxDM",
    "website": "https://hqpittsburgh.com/",
    "locations": ""
  },
  {
    "region": "Atlanta",
    "state": "Georgia",
    "country": "United States",
    "loc": [33.748995, -84.387982],
    "pdf": "",
    "video": "https://www.youtube.com/watch?v=LpvlxV8PUDA",
    "website": "",
    "locations": ""
  },
  {
    "region": "Boston",
    "state": "Massachusettes",
    "country": "United States",
    "loc": [42.360083, -71.05888],
    "pdf": "https://www.bostonglobe.com/metro/2017/10/19/read-boston-full-bid-amazon/gmlG1jBfH2aGTftHNcHq0M/story.html",
    "video": "https://www.youtube.com/watch?v=GryWPJYtVMY",
    "website": "https://amazon.boston.gov/",
    "locations": ""
  },
  {
    "region": "Buffalo - Rochester",
    "state": "New York",
    "country": "United States",
    "loc": [42.886447, -78.878369],
    "pdf": "",
    "video": "https://www.youtube.com/watch?v=ywdttTRP7uA",
    "website": "",
    "locations": ""
  },
  {
    "region": "Calgary",
    "state": "Alberta",
    "country": "Canada",
    "loc": [51.0486, 114.0708],
    "pdf": "",
    "video": "https://www.youtube.com/watch?v=avsRTyz30es",
    "website": "",
    "locations": ""
  },
  {
    "region": "Camden",
    "state": "New Jersey",
    "country": "United States",
    "loc": [39.925946, -75.11962],
    "pdf": "https://www.dropbox.com/s/21ax2p1vq9p5haf/Amazon_HQ2_101017.pdf",
    "video": "",
    "website": "",
    "locations": ""
  },
  {
    "region": "Charlotte",
    "state": "North Carolina",
    "country": "United States",
    "loc": [35.227087, -80.843127],
    "pdf": "",
    "video": "https://www.youtube.com/watch?v=oJNMSNsE31U",
    "website": "",
    "locations": ""
  },
  {
    "region": "Chicago",
    "state": "Illinois",
    "country": "United States",
    "loc": [41.878114, -87.629798],
    "pdf": "",
    "video": "",
    "website": "",
    "locations": "https://chicago.curbed.com/2017/10/23/16512138/chicago-amazon-hq2-bid"
  },
  {
    "region": "Chula Vista",
    "state": "California",
    "country": "United States",
    "loc": [32.6401, 117.0842],
    "pdf": "https://www.amazonhqmillenia.com/docs/ChulaVistaAmazonBook.pdf",
    "video": "https://www.amazonhqmillenia.com/",
    "website": "",
    "locations": "https://www.amazonhqmillenia.com/docs/AmazonHQ2Presentation.pdf"
  },
  {
    "region": "Corazón",
    "state": "Guayama",
    "country": "Puerto Rico",
    "loc": [17.97417, -66.11000],
    "pdf": "",
    "video": "https://www.youtube.com/watch?v=pktsqyw1rjM",
    "website": "",
    "locations": ""
  },
  {
    "region": "Dallas - Fort Worth",
    "state": "Texas",
    "country": "United States",
    "loc": [32.776664, -96.796988],
    "pdf": "",
    "video": "https://www.youtube.com/watch?v=BQ2qtQ4OS2k",
    "website": "",
    "locations": "https://media.bizj.us/view/img/10645248/dfwamazonmap.pdf"
  },
  {
    "region": "Danbury",
    "state": "Connecticut",
    "country": "United States",
    "loc": [41.394817, -73.454011],
    "pdf": "",
    "video": "https://www.youtube.com/watch?v=rN6uy4MmQic",
    "website": "",
    "locations": ""
  },
  {
    "region": "Detroit",
    "state": "Michigan",
    "country": "United States",
    "loc": [42.331427, -83.045754],
    "pdf": "",
    "video": "https://www.youtube.com/watch?v=DO4J_PC1b5M",
    "website": "",
    "locations": ""
  },
  {
    "region": "Fairplex",
    "state": "California",
    "country": "United States",
    "loc": [34.08098, -117.765195],
    "pdf": "",
    "video": "https://www.youtube.com/watch?time_continue=2&v=MY3xUnA3uEo",
    "website": "http://www.fairplex.com/aboutus/ceo/amazon-polyplex",
    "locations": ""
  }
];
    </script>
  </head>

  <body lang="en">

    <nav class="navbar">
      <a class="navbar-brand" href="#">Amazon HQ2 Proposals</a>

      <div class="collapse navbar-collapse">
        <!--
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
            </li>
          </ul>
        -->
      </div>
    </nav>

    <div class="jumbotron">
      <div class="container">
        <div class="info">
          <p><a href="#">Contribute</a> to this open source project. Work with <a href="#">our team</a> to extract meaning from this cultural and historical bid.</p>
        </div>
        <div id="my-map"></div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <table class="table table-hover" id="proposals">
          <thead class="thead-inverse">
            <tr>
              <th>City/Region</th>
              <th>State</th>
              <th>Country</th>
              <th></th>
            </tr>
          </thead>

          <tbody id="proposals-tbody">
          </tbody>
        </table>
      </div>
     </div>

     <footer class="footer">
      <div class="container">
        <span class="text-muted">All content property of it's respective owners.</span>
      </div>
    </footer>
  </body>

  <script type="text/javascript">
var slug = function(str) {
  return str.toLowerCase().replace(/[^a-zA-Z0-0]/g, '-').replace(/-+/, '-');
}

var createId = function(prop) {
  return slug(prop.country) + '-' + slug(prop.region);
}

var createLink = function(fa, href) {
  var span = $('<span class="resource" />'),
      icon = $('<i class="fa" aria-hidden="true" />');

  icon.addClass(fa);

  if (href != "") {
    var link = $('<a target="_blank" />');
    link.attr("href", href)
    link.append(icon);

    span.append(link);
  } else {
    icon.addClass('icon-disabled');
    span.append(icon);
  }

  return span;
}

function renderPropsals(tbody, props) {
  var len = props.length,
      $tbody = $(tbody);

  // Stupp for the map.
  var mymap = L.map('my-map').setView([39.50,-98.35], 4);

  L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
    maxZoom: 18,
    id: 'mapbox.streets',
    accessToken: 'pk.eyJ1IjoiYnJhZGhlIiwiYSI6ImNpamZ5YzNpYjAwMzJ1NG01OTh1NmYwZGkifQ.xnt-BjEXZZ5vw3gryLfMpA'
  }).addTo(mymap);

  for (var i = 0; i < len; i++) {
    var prop = props[i],
        $tr = $('<tr/>'),
        $regionTd = $('<td/>'),
        $stateTd = $('<td/>'),
        $countryTd = $('<td/>'),
        $linkTd = $('<td align="right"/>');

    $regionTd.text(prop.region);
    $stateTd.text(prop.state);
    $countryTd.text(prop.country);
    $linkTd.append(createLink('fa-file-pdf-o', prop.pdf));
    $linkTd.append(createLink('fa-video-camera', prop.video));
    $linkTd.append(createLink('fa-location-arrow', prop.website));
    $linkTd.append(createLink('fa-map-marker', prop.locations));

    var id = createId(prop);
    $tr.attr('id', id);
    $tr.append($regionTd);
    $tr.append($stateTd);
    $tr.append($countryTd);
    $tr.append($linkTd);

    $tbody.append($tr);

    var marker = L.marker(prop.loc).addTo(mymap);

    (function(id){
      marker.on('click', function() {
        window.location.hash = id;

        // Highlight this row in the table too
        $('#'+id).siblings('.table-active').removeClass('table-active');
        $('#'+id).addClass('table-active');
      });
    })(id);
  }
}

$(function() {
  renderPropsals(document.getElementById('proposals-tbody'), window.PROPOSALS);
});
  </script>
</html>
